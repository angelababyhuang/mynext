# 实施计划

## 阶段1：项目基础设置和核心数据模型

- [ ] 1. 初始化Next.js项目和基础配置
  - 创建Next.js 14项目（使用App Router）
  - 配置TypeScript和基础的tsconfig.json
  - 安装和配置Tailwind CSS
  - 安装shadcn/ui并初始化组件库
  - 设置基础的项目目录结构
  - _需求: 6.1, 6.4_

- [ ] 2. 实现核心数据模型和类型定义
  - 创建TypeScript接口定义（KnowledgeCard, Book, Chapter, TreeNode等）
  - 实现数据验证函数
  - 创建数据模型的单元测试
  - _需求: 1.6, 3.1, 3.2, 3.3_

- [ ] 3. 设置本地数据存储
  - 安装和配置Dexie.js用于IndexedDB操作
  - 实现CourseNotesDB数据库类
  - 创建数据库初始化和迁移逻辑
  - 编写数据库操作的基础CRUD方法
  - 测试数据持久化功能
  - _需求: 1.6, 3.6_

## 阶段2：基础知识卡片功能

- [ ] 4. 实现基础知识卡片组件
  - 创建KnowledgeCard显示组件
  - 实现卡片列表视图组件
  - 添加卡片的基础CRUD操作界面
  - 实现卡片搜索和过滤功能
  - _需求: 1.1, 1.6_

- [ ] 5. 实现Markdown编辑器
  - 集成@uiw/react-md-editor组件
  - 配置Markdown实时预览功能
  - 实现基础的Markdown渲染
  - 添加编辑器的保存和取消功能
  - 测试Markdown内容的正确渲染
  - _需求: 1.1, 1.2_

- [ ] 6. 添加代码块语法高亮支持
  - 集成Prism.js进行代码语法高亮
  - 配置常用编程语言的高亮支持
  - 在Markdown预览中正确显示代码块
  - 测试各种编程语言的高亮效果
  - _需求: 1.4_

- [ ] 7. 实现数学公式渲染
  - 集成KaTeX库用于数学公式渲染
  - 配置LaTeX语法支持
  - 在Markdown编辑器中添加数学公式预览
  - 测试各种数学公式的正确渲染
  - _需求: 1.5_

## 阶段3：层次结构管理

- [ ] 8. 实现书籍管理功能
  - 创建Book创建和编辑组件
  - 实现书籍列表显示
  - 添加书籍的CRUD操作
  - 实现书籍的基础信息管理
  - _需求: 3.1_

- [ ] 9. 实现章节管理功能
  - 创建Chapter创建和编辑组件
  - 实现章节在书籍下的层次显示
  - 添加章节的CRUD操作和排序功能
  - 建立书籍与章节的关联关系
  - _需求: 3.2_

- [ ] 10. 实现知识卡片与章节的关联
  - 将知识卡片分配到指定章节
  - 实现卡片在章节间的移动功能
  - 创建层次结构的树形显示组件
  - 添加拖拽重新组织结构的基础功能
  - _需求: 3.3, 3.4, 3.5_

## 阶段4：图片上传和媒体支持

- [ ] 11. 实现图片上传功能
  - 创建图片上传组件
  - 实现拖拽上传图片到编辑器
  - 添加图片的本地存储和管理
  - 在Markdown预览中正确显示图片
  - 优化图片显示和加载性能
  - _需求: 1.3_

- [ ] 12. 优化媒体文件管理
  - 实现图片文件的压缩和优化
  - 添加图片的删除和替换功能
  - 创建媒体文件的管理界面
  - 实现图片的懒加载
  - _需求: 1.3, 6.1_

## 阶段5：可拖拽节点编辑器

- [ ] 13. 集成React Flow基础功能
  - 安装和配置React Flow库
  - 创建基础的节点编辑器组件
  - 实现节点的显示和基础交互
  - 添加画布的缩放和平移功能
  - _需求: 2.1_

- [ ] 14. 实现知识卡片节点
  - 创建自定义的知识卡片节点组件
  - 将知识卡片数据映射到节点显示
  - 实现节点的拖拽移动功能
  - 添加节点位置的持久化存储
  - _需求: 2.2, 2.6_

- [ ] 15. 实现节点连接功能
  - 添加节点间的连接线显示
  - 实现拖拽创建节点连接
  - 建立节点间的关系数据模型
  - 添加连接关系的管理功能
  - _需求: 2.3, 2.4_

- [ ] 16. 优化节点编辑器交互
  - 实现双击节点打开卡片编辑
  - 添加节点的右键菜单功能
  - 实现节点的选择和批量操作
  - 优化大量节点时的性能
  - _需求: 2.5_

## 阶段6：状态管理和用户界面

- [ ] 17. 实现全局状态管理
  - 安装和配置Zustand状态管理库
  - 创建应用的全局状态结构
  - 实现状态的持久化和恢复
  - 添加状态变更的调试工具
  - _需求: 6.4_

- [ ] 18. 创建主导航和布局
  - 设计和实现应用的主布局组件
  - 创建导航菜单和路由结构
  - 实现不同视图间的切换
  - 添加响应式布局支持
  - _需求: 6.2, 6.3_

- [ ] 19. 实现用户界面优化
  - 添加加载状态和进度指示器
  - 实现操作的视觉反馈效果
  - 创建友好的错误提示组件
  - 优化界面的过渡动画
  - _需求: 6.1, 6.4, 6.5_

## 阶段7：PDF导出功能

- [ ] 20. 实现基础PDF导出
  - 安装和配置jsPDF和html2canvas库
  - 创建PDF导出的基础功能
  - 实现单个知识卡片的PDF导出
  - 测试PDF生成的正确性
  - _需求: 4.4_

- [ ] 21. 实现导出模板系统
  - 创建导出模板的数据模型
  - 实现预设模板（学术、总结、闪卡格式）
  - 添加模板选择和预览功能
  - 实现自定义模板的创建和保存
  - _需求: 4.1, 4.2, 4.5_

- [ ] 22. 优化PDF导出质量
  - 确保图片和数学公式在PDF中正确渲染
  - 优化PDF的布局和格式
  - 添加导出进度指示和错误处理
  - 实现批量导出功能
  - _需求: 4.3, 4.6_

## 阶段8：复习系统

- [ ] 23. 实现基础复习数据模型
  - 创建ReviewData数据结构
  - 实现复习记录的存储和管理
  - 添加复习难度评级功能
  - 创建复习统计的基础计算
  - _需求: 5.4, 5.5_

- [ ] 24. 实现复习算法
  - 研究和实现基于遗忘曲线的复习算法
  - 创建复习时间计算逻辑
  - 实现复习优先级排序
  - 添加复习计划的自动调整
  - _需求: 5.1, 5.5_

- [ ] 25. 创建复习界面
  - 设计和实现复习模式的用户界面
  - 创建复习卡片的展示组件
  - 添加复习进度和统计显示
  - 实现复习提醒功能
  - _需求: 5.2, 5.3, 5.6_

## 阶段9：测试和优化

- [ ] 26. 实现单元测试
  - 为核心组件编写单元测试
  - 测试数据模型和工具函数
  - 添加状态管理的测试
  - 确保测试覆盖率达到80%以上
  - _需求: 6.5_

- [ ] 27. 实现集成测试
  - 测试组件间的交互功能
  - 验证数据流的正确性
  - 测试用户工作流的完整性
  - 添加错误场景的测试用例
  - _需求: 6.5_

- [ ] 28. 性能优化和最终调试
  - 优化应用的加载速度和响应性能
  - 实现代码分割和懒加载
  - 优化大量数据时的渲染性能
  - 修复发现的bug和用户体验问题
  - _需求: 6.1, 6.2_

## 阶段10：帮助文档和部署

- [ ] 29. 创建帮助文档和用户指南
  - 编写应用的使用说明文档
  - 创建功能演示和教程
  - 添加应用内的帮助提示
  - 实现新用户的引导流程
  - _需求: 6.6_

- [ ] 30. 准备生产部署
  - 配置生产环境的构建设置
  - 优化应用的SEO和性能指标
  - 添加错误监控和日志记录
  - 测试应用在不同浏览器的兼容性
  - _需求: 6.1, 6.3_